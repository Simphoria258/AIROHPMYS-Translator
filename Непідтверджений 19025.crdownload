// –î–æ–±–∞–≤—å—Ç–µ –≤ –Ω–∞—á–∞–ª–æ —Ñ–∞–π–ª–∞
let currentTheme = 'dark';

// –û–±–Ω–æ–≤–∏—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é toggleTheme
function toggleTheme() {
    currentTheme = currentTheme === 'dark' ? 'light' : 'dark';
    document.body.classList.toggle("light-theme");
    localStorage.setItem('theme', currentTheme);
    
    // –ü–ª–∞–≤–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ç–µ–º—ã
    document.body.style.transition = 'background 0.5s, color 0.5s';
    setTimeout(() => document.body.style.transition = '', 500);
}

// –î–æ–±–∞–≤—å—Ç–µ –Ω–æ–≤—É—é —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
function showNotification(message) {
    const notification = document.getElementById('notification');
    notification.textContent = message;
    notification.style.display = 'block';
    notification.style.animation = 'none';
    void notification.offsetWidth;
    notification.style.animation = 'fadeOut 3s forwards';
}

// –û–±–Ω–æ–≤–∏—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é translate
function translate() {
    const input = document.getElementById("input").value.trim();
    if (!input) {
        showNotification("Please enter text to translate!");
        return;
    }

    try {
        sounds.click.play().catch(e => console.error("Sound error:", e));
        
        let output = input.toLowerCase();
        for (const [word, translation] of Object.entries(dictionary)) {
            const regex = new RegExp(`\\b${word}\\b`, 'gi');
            output = output.replace(regex, translation);
        }

        output = output.toUpperCase();
        const glyphOutput = output.split('').map(char => glyphs[char] || char).join('');

        document.getElementById("output").textContent = output;
        document.getElementById("glyphs").innerHTML = glyphOutput.split("").map(g =>
            `<span class="glyph" onclick="speak('${g}')" title="Click to hear">${g}</span>`
        ).join("");

        if (Math.random() > 0.7) {
            sounds.bell.play().catch(e => console.error("Bell sound error:", e));
        }
    } catch (error) {
        console.error("Translation error:", error);
        showNotification("Translation failed. Please try again.");
    }
}

// –û–±–Ω–æ–≤–∏—Ç–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –ø–æ output
document.getElementById("output").addEventListener("click", function() {
    navigator.clipboard.writeText(this.textContent)
        .then(() => showNotification("üìã Copied to clipboard!"))
        .catch(() => showNotification("‚ùå Copy failed"));
});

// –î–æ–±–∞–≤—å—Ç–µ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
document.addEventListener('DOMContentLoaded', function() {
    // –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–µ–º—ã
    const savedTheme = localStorage.getItem('theme') || 'dark';
    if (savedTheme === 'light') {
        document.body.classList.add('light-theme');
        currentTheme = 'light';
    }
    
    // –ü—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∞ –∑–≤—É–∫–æ–≤
    Object.values(sounds).forEach(sound => {
        sound.load();
        sound.volume = 0.6;
    });
    
    // –§–æ–∫—É—Å –Ω–∞ –ø–æ–ª–µ –≤–≤–æ–¥–∞
    document.getElementById('input').focus();
});